{
    "contents" : "---\ntitle: \"Which mutation transitions and drug concentrations influence growth?\"\nauthor: \"Andrew Nguyen\"\ndate: \"2016-February-27\"\noutput: \n  pdf_document: \n    toc: true\n---\n\n#regression trees\n**load libraies and read in data**\n```{r library and data}\nlibrary(ggplot2)\nlibrary(tidyr)\nlibrary(rpart)\nlibrary(rpart.plot)\n\n\nmal_long<-read.csv(\"../Data/20160227_final_dataset_malaria_pyr_cyc_abs_relative.csv\")\n```\n\n##Regression tree analysis for pyr\n###pyr delta fitness\n```{r regression tree for pyr}\n#construct formula\nform<-as.formula(pyr_abs~changed+drug)\n#construct regression tree\ntree.1<-rpart(form,data=mal_long,control=rpart.control(minsplit=20,cp=0),method=\"anova\")\nprintcp(tree.1)\n#prune tree\ntree.1$cptable[which.min(tree.1$cptable[,\"xerror\"]),\"CP\"]\nnew.tree<-prune(tree.1, cp=0)\n#plot tree\nrpart.plot(new.tree,type=3,extra=100)\n#checking variation explained\nmal_long$predicted<-predict(new.tree)\n#linear model\nmod1<-lm(pyr_abs~predicted,data=mal_long)\nsummary(mod1)\n#color by start\nplot(mal_long$predicted,mal_long$pyr_abs,col=as.factor(mal_long$start))\n\n\n#color by change class\n#point size correspond to drug\nmal_long$sizing<-c(rep(.5,32),rep(2.75,32),rep(1,32),rep(1.25,32),rep(1.5,32),rep(2,32),rep(2.5,32),rep(3,32),rep(3.5,32),rep(4,32))\n\nplot(mal_long$predicted,mal_long$pyr_abs,col=as.factor(mal_long$changed),pch=16,cex=2)\n#,cex=mal_long$sizing\n\n#,xlim=c(-2,2),ylim=c(-1.5,1.5)\nabline(mod1)\n\n#checking the residuals\npar(mfrow=c(2,2))\nplot(mod1)\npar(mfrow=c(1,1))\n```\n###pyr relative fitness\n```{r pyr relative fitness}\nform<-as.formula(pyr_relative_measure~changed+drug)\n#construct regression tree\npyr_rel_meas<-rpart(form,data=mal_long,control=rpart.control(minsplit=20,cp=0),method=\"anova\")\nprintcp(pyr_rel_meas)\n#prune tree\npyr_rel_meas$cptable[which.min(pyr_rel_meas$cptable[,\"xerror\"]),\"CP\"]\npyr_rel_meas2<-prune(pyr_rel_meas, cp=0)\n#plot tree\nrpart.plot(pyr_rel_meas2,type=3,extra=100)\n#checking variation explained\nmal_long$pyr_rel_meas_predicted<-predict(new.tree)\n#linear model\nmod2<-lm(pyr_abs~pyr_rel_meas_predicted,data=mal_long)\nsummary(mod2)\n#color by start\nplot(mal_long$pyr_rel_meas_predicted,mal_long$pyr_abs,col=as.factor(mal_long$start))\nabline(mod2)\n\n#checking the residuals\npar(mfrow=c(2,2))\nplot(mod2)\npar(mfrow=c(1,1))\n```\n\n\n##Regression tree analysis for cyc\n###cyc delta fitness\n```{r cyc relative fitness}\nform<-as.formula(cyc_relative~changed+drug)\n#construct regression tree\ncyc_relative_tree<-rpart(form,data=mal_long,control=rpart.control(minsplit=20,cp=0),method=\"anova\")\nprintcp(cyc_relative_tree)\n#prune tree\ncyc_relative_tree$cptable[which.min(cyc_relative_tree$cptable[,\"xerror\"]),\"CP\"]\ncyc_relative_tree2<-prune(cyc_relative_tree, cp=00498)\n#plot tree\nrpart.plot(cyc_relative_tree,type=3,extra=100)\n\nmal_long$cyc_relative_prediction<-predict(cyc_relative_tree)\nmod6<-lm(cyc_relative~cyc_relative_prediction,data=mal_long)\nsummary(mod6)\n\nplot(mal_long$cyc_relative,mal_long$cyc_relative_prediction)\nabline(mod6)\n```\n\n###cyc relative fitness\n```{r cyc delta fitness}\nform<-as.formula(cyc_abs~changed+drug)\n#construct regression tree\ncyc_abs_tree<-rpart(form,data=mal_long,control=rpart.control(minsplit=20,cp=0),method=\"anova\")\nprintcp(cyc_abs_tree)\n#prune tree\ncyc_abs_tree$cptable[which.min(cyc_abs_tree$cptable[,\"xerror\"]),\"CP\"]\ncyc_abs_tree2<-prune(cyc_abs_tree, cp=0)\n#plot tree\nrpart.plot(cyc_abs_tree2,type=3,extra=100)\n\nmal_long$cyc_abs_prediction<-predict(cyc_abs_tree2)\nmod5<-lm(cyc_abs~cyc_abs_prediction,data=mal_long)\nsummary(mod5)\n\nplot(mal_long$cyc_abs,mal_long$cyc_abs_prediction)\nabline(mod5)\n```\n\n#SessionInfo\n```{r session info}\nsessionInfo()\n```\n\n",
    "created" : 1456622534726.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "11|23|19|3|\n23|30|57|3|\n59|27|82|3|\n87|27|104|3|\n107|24|124|3|\n127|19|129|3|\n",
    "hash" : "1165433011",
    "id" : "BD94A531",
    "lastKnownWriteTime" : 1456623975,
    "path" : "~/Desktop/malaria_resistance/Script/20160227_regression_tree_analysis.Rmd",
    "project_path" : "20160227_regression_tree_analysis.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_markdown"
}